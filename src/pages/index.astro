---
// Agracom Internacional S.A. - Página Principal (Multi-idioma)
import Layout from '../components/layout/Layout.astro';
import Header from '../components/layout/Header.astro';
import Hero from '../components/sections/Hero.astro';
import ProductCard from '../components/ui/ProductCard.astro';
import Certifications from '../components/sections/Certifications.astro';
import Regions from '../components/sections/Regions.astro';
import ContactForm from '../components/forms/ContactForm.astro';
import Footer from '../components/layout/Footer.astro';
// Removed unused import

// Detect language from URL (?lang=en|es), fallback to 'es'
const urlLang = Astro.url.searchParams.get('lang');
const lang = (urlLang === 'en' || urlLang === 'es') ? urlLang : 'es';

// Títulos y descripciones según idioma
const seoData = {
  es: {
    title: 'Lupinos Premium y Cerezas Certificadas desde Chile',
    description: 'Exportadores especializados en lupinos premium calibres 11-17mm y cerezas deshidratadas Santina con certificaciones Kosher y Halal. 20+ años de experiencia.',
    canonicalURL: 'https://agracom-internacional.com/'
  },
  en: {
    title: 'Premium Lupins and Certified Cherries from Chile',
    description: 'Specialized exporters of premium lupins 11-17mm caliber and Santina dried cherries with Kosher and Halal certifications. 20+ years of experience.',
    canonicalURL: 'https://agracom-internacional.com/?lang=en'
  }
};

const { title, description, canonicalURL } = seoData[lang];

// Load product data
const lupinsData = await import('../data/products/lupins.json');
const cherriesData = await import('../data/products/cherries.json');

// Create product objects según idioma
const lupinsProduct = {
  id: lupinsData.id,
  name: lang === 'en' ? lupinsData.nameEn : lupinsData.name,
  image: lupinsData.image,
  description: lang === 'en' ? lupinsData.descriptionEn : lupinsData.description,
  specifications: lang === 'en' ? lupinsData.specificationsEn : lupinsData.specifications,
  certifications: lupinsData.certifications as any,
  category: lupinsData.category as 'lupins',
  available: lupinsData.available
};

const cherriesProduct = {
  id: cherriesData.id,
  name: lang === 'en' ? cherriesData.nameEn : cherriesData.name,
  image: cherriesData.image,
  description: lang === 'en' ? cherriesData.descriptionEn : cherriesData.description,
  specifications: lang === 'en' ? cherriesData.specificationsEn : cherriesData.specifications,
  certifications: cherriesData.certifications as any,
  category: cherriesData.category as 'cherries',
  available: cherriesData.available
};

// Contenido de secciones según idioma
const sectionContent = {
  es: {
    productsId: 'productos',
    productsTitle: 'Nuestros Productos Especializados',
    productsDescription: 'Especialistas boutique en lupinos premium y cerezas deshidratadas certificadas, con 20+ años de experiencia exportando a mercados exigentes.'
  },
  en: {
    productsId: 'products',
    productsTitle: 'Our Specialized Products',
    productsDescription: 'Boutique specialists in premium lupins and certified dried cherries, with 20+ years of experience exporting to demanding markets.'
  }
};

const content = sectionContent[lang];
---

<Layout 
  title={title}
  description={description}
  lang={lang}
  canonicalURL={canonicalURL}
>
  <!-- Header -->
  <Header slot="header" currentLang={lang} />

  <!-- Hero Section -->
  <Hero lang={lang} />

  <!-- Products Section -->
  <section id={content.productsId} class="section bg-white">
    <div class="container mx-auto px-4">
      <div class="text-center space-y-6 mb-12">
        <h2 class="text-h2 font-bold text-neutral-900" data-products-title>
          {content.productsTitle}
        </h2>
        <p class="text-xl text-neutral-700 max-w-3xl mx-auto" data-products-description>
          {content.productsDescription}
        </p>
      </div>
      
      <div class="product-grid">
        <!-- Lupinos Product Card -->
        <ProductCard 
          product={lupinsProduct}
          variant="featured"
          lang={lang}
          showActions={true}
          showCertifications={true}
          showSpecifications={true}
        />
        
        <!-- Cerezas Product Card -->
        <ProductCard 
          product={cherriesProduct}
          variant="featured"
          lang={lang}
          showActions={true}
          showCertifications={true}
          showSpecifications={true}
        />
      </div>
    </div>
  </section>

  <!-- Certifications Section -->
  <Certifications lang={lang} />

  <!-- Regions Section -->
  <Regions lang={lang} />

  <!-- Contact Section -->
  <ContactForm lang={lang} />

  <!-- Footer -->
  <Footer slot="footer" lang={lang} showSocial={true} />

</Layout>
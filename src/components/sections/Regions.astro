---
// Agracom Internacional S.A. - Regions Section
// Secci√≥n de regiones con informaci√≥n espec√≠fica por mercado

import type { Locale, Region } from '../../types/global';
import { createTranslator } from '../../utils/i18n';

export interface Props {
  lang: Locale;
  selectedRegion?: Region;
  interactive?: boolean;
  showStats?: boolean;
  class?: string;
}

const {
  lang,
  selectedRegion,
  interactive = true,
  showStats = true,
  class: className = ''
} = Astro.props;

// Load translations
const { regions, common } = await createTranslator(lang);

// Comprehensive regions data
const regionsData = [
  {
    id: 'us-east',
    name: 'Costa Este EE.UU.',
    nameEn: 'US East Coast',
    flag: 'üá∫üá∏',
    icon: '/images/region-us-east.svg',
    color: 'primary',
    bgGradient: 'from-primary/10 to-primary/20',
    description: 'Mercado premium con alta demanda de productos certificados Kosher y org√°nicos.',
    descriptionEn: 'Premium market with high demand for Kosher certified and organic products.',
    
    // Market details
    marketSize: '$2.1B',
    growthRate: '8.5%',
    keyPorts: ['Nueva York', 'Boston', 'Baltimore'],
    keyPortsEn: ['New York', 'Boston', 'Baltimore'],
    
    // Shipping information
    shipping: {
      transit: '10-14',
      transitUnit: lang === 'es' ? 'd√≠as' : 'days',
      frequency: lang === 'es' ? 'Semanal' : 'Weekly',
      method: 'Container 20\'/40\'',
      incoterm: 'CIF'
    },
    
    // Product preferences
    products: {
      lupins: {
        demand: 'high',
        calibers: ['11-13mm', '14-16mm'],
        packaging: ['25kg bags', '50kg bags'],
        certifications: ['SAG', 'USDA Organic'],
        seasonality: lang === 'es' ? 'Todo el a√±o' : 'Year-round'
      },
      cherries: {
        demand: 'very-high',
        packaging: ['5kg boxes', '10kg boxes'],
        certifications: ['Kosher OU', 'SAG'],
        seasonality: lang === 'es' ? 'Diciembre-Febrero' : 'December-February'
      }
    },
    
    // Executive contact
    executive: {
      name: 'Cristi√°n Rodr√≠guez',
      title: lang === 'es' ? 'Ejecutivo Regional Costa Este' : 'East Coast Regional Executive',
      email: 'cristian@agracom.cl',
      phone: '+56 9 1234 5678',
      languages: ['Espa√±ol', 'English'],
      experience: '8+ a√±os'
    },
    
    // Market insights
    insights: [
      {
        title: lang === 'es' ? 'Tendencia Kosher' : 'Kosher Trend',
        value: '+15%',
        desc: lang === 'es' ? 'Crecimiento anual' : 'Annual growth'
      },
      {
        title: lang === 'es' ? 'Precio Premium' : 'Premium Price',
        value: '25-30%',
        desc: lang === 'es' ? 'Sobre commodity' : 'Above commodity'
      }
    ],
    
    clients: 15,
    established: 2016,
    featured: true
  },
  
  {
    id: 'mediterranean',
    name: 'Mediterr√°neo',
    nameEn: 'Mediterranean',
    flag: 'üåä',
    icon: '/images/region-mediterranean.svg',
    color: 'secondary',
    bgGradient: 'from-secondary/10 to-secondary/20',
    description: 'Regi√≥n tradicional con amplio conocimiento de lupinos y demanda constante.',
    descriptionEn: 'Traditional region with extensive lupin knowledge and consistent demand.',
    
    marketSize: '$850M',
    growthRate: '5.2%',
    keyPorts: ['Valencia', 'G√©nova', 'El Pireo'],
    keyPortsEn: ['Valencia', 'Genoa', 'Piraeus'],
    
    shipping: {
      transit: '15-20',
      transitUnit: lang === 'es' ? 'd√≠as' : 'days',
      frequency: lang === 'es' ? 'Quincenal' : 'Bi-weekly',
      method: 'Container 20\'/40\'',
      incoterm: 'CIF'
    },
    
    products: {
      lupins: {
        demand: 'very-high',
        calibers: ['11-13mm', '14-16mm', '17mm+'],
        packaging: ['25kg bags', '50kg bags', 'Big bags 1000kg'],
        certifications: ['SAG'],
        seasonality: lang === 'es' ? 'Todo el a√±o' : 'Year-round'
      },
      cherries: {
        demand: 'medium',
        packaging: ['5kg boxes'],
        certifications: ['SAG'],
        seasonality: lang === 'es' ? 'Diciembre-Febrero' : 'December-February'
      }
    },
    
    executive: {
      name: 'Pedro Mendive',
      title: lang === 'es' ? 'Ejecutivo Regional Mediterr√°neo' : 'Mediterranean Regional Executive',
      email: 'pedro@agracom.cl',
      phone: '+56 9 8765 4321',
      languages: ['Espa√±ol', 'Italiano', 'English'],
      experience: '12+ a√±os'
    },
    
    insights: [
      {
        title: lang === 'es' ? 'Mercado Estable' : 'Stable Market',
        value: '95%',
        desc: lang === 'es' ? 'Retenci√≥n clientes' : 'Client retention'
      },
      {
        title: lang === 'es' ? 'Volumen Anual' : 'Annual Volume',
        value: '2,500MT',
        desc: lang === 'es' ? 'Promedio' : 'Average'
      }
    ],
    
    clients: 20,
    established: 2012,
    featured: true
  },
  
  {
    id: 'middle-east',
    name: 'Medio Oriente',
    nameEn: 'Middle East',
    flag: 'üïå',
    icon: '/images/region-middle-east.svg',
    color: 'accent',
    bgGradient: 'from-accent/10 to-accent/20',
    description: 'Mercado especializado en productos Halal con alto valor agregado.',
    descriptionEn: 'Specialized market in Halal products with high added value.',
    
    marketSize: '$420M',
    growthRate: '12.8%',
    keyPorts: ['Jebel Ali', 'Doha', 'Kuwait'],
    keyPortsEn: ['Jebel Ali', 'Doha', 'Kuwait'],
    
    shipping: {
      transit: '18-25',
      transitUnit: lang === 'es' ? 'd√≠as' : 'days',
      frequency: lang === 'es' ? 'Mensual' : 'Monthly',
      method: 'Container 20\'/40\'',
      incoterm: 'CIF'
    },
    
    products: {
      lupins: {
        demand: 'medium',
        calibers: ['14-16mm', '17mm+'],
        packaging: ['25kg bags', '50kg bags'],
        certifications: ['SAG', 'Halal'],
        seasonality: lang === 'es' ? 'Todo el a√±o' : 'Year-round'
      },
      cherries: {
        demand: 'high',
        packaging: ['5kg boxes', '10kg boxes', '20kg boxes'],
        certifications: ['Halal CIC', 'SAG'],
        seasonality: lang === 'es' ? 'Todo el a√±o (deshidratadas)' : 'Year-round (dried)'
      }
    },
    
    executive: {
      name: 'Cristi√°n Rodr√≠guez',
      title: lang === 'es' ? 'Ejecutivo Regional Medio Oriente' : 'Middle East Regional Executive',
      email: 'cristian@agracom.cl',
      phone: '+56 9 1234 5678',
      languages: ['Espa√±ol', 'English', 'ÿßŸÑÿπÿ±ÿ®Ÿäÿ©'],
      experience: '5+ a√±os'
    },
    
    insights: [
      {
        title: lang === 'es' ? 'Certificaci√≥n Halal' : 'Halal Certification',
        value: '100%',
        desc: lang === 'es' ? 'Productos certificados' : 'Certified products'
      },
      {
        title: lang === 'es' ? 'Crecimiento' : 'Growth',
        value: '+25%',
        desc: lang === 'es' ? '√öltimos 2 a√±os' : 'Last 2 years'
      }
    ],
    
    clients: 8,
    established: 2019,
    featured: true
  }
];

// Get current region data
const currentRegion = selectedRegion ? regionsData.find(r => r.id === selectedRegion) : null;
const displayRegion = currentRegion || (!selectedRegion ? regionsData[0] : null);
---

<section 
  id={lang === 'es' ? 'regiones' : 'regions'}
  class={`section bg-gradient-to-br from-neutral-50 to-white ${className}`}
  aria-label={lang === 'es' ? 'Regiones y mercados' : 'Regions and markets'}
>
  <div class="container mx-auto px-4">
    
    <!-- Section Header -->
    <div class="text-center space-y-6 mb-16">
      <div class="space-y-4">
        <h2 class="text-h2 font-bold text-neutral-900">
          {lang === 'es' ? 'Presencia Global, Servicio Local' : 'Global Presence, Local Service'}
        </h2>
        <p class="text-xl text-neutral-700 max-w-3xl mx-auto leading-relaxed">
          {lang === 'es' 
            ? 'Conectamos la calidad chilena con mercados especializados alrededor del mundo, con ejecutivos dedicados que entienden cada regi√≥n.'
            : 'We connect Chilean quality with specialized markets around the world, with dedicated executives who understand each displayRegion.'
          }
        </p>
      </div>

      {/* Global Stats */}
      {showStats && (
        <div class="flex flex-wrap justify-center items-center gap-8 pt-8">
          <div class="text-center">
            <div class="text-3xl font-bold text-primary">17</div>
            <div class="text-sm text-neutral-600 font-medium">
              {lang === 'es' ? 'Pa√≠ses' : 'Countries'}
            </div>
          </div>
          <div class="text-center">
            <div class="text-3xl font-bold text-secondary">40+</div>
            <div class="text-sm text-neutral-600 font-medium">
              {lang === 'es' ? 'Clientes Activos' : 'Active Clients'}
            </div>
          </div>
          <div class="text-center">
            <div class="text-3xl font-bold text-accent">20+</div>
            <div class="text-sm text-neutral-600 font-medium">
              {lang === 'es' ? 'A√±os de Experiencia' : 'Years of Experience'}
            </div>
          </div>
          <div class="text-center">
            <div class="text-3xl font-bold text-info">270+</div>
            <div class="text-sm text-neutral-600 font-medium">
              {lang === 'es' ? 'Embarques Exitosos' : 'Successful Shipments'}
            </div>
          </div>
        </div>
      )}
    </div>

    <!-- Interactive Region Selector -->
    {interactive && (
      <div class="mb-16">
        <div class="flex justify-center">
          <div class="inline-flex bg-white rounded-2xl p-2 shadow-lg border border-neutral-200">
            {regionsData.map((region) => (
              <button
                type="button"
                class={`region-selector px-6 py-4 rounded-xl font-medium transition-all duration-300 flex items-center space-x-3 ${
                  (!selectedRegion && region.id === 'us-east') || selectedRegion === region.id
                    ? `bg-${region.color} text-white shadow-md`
                    : 'text-neutral-600 hover:bg-neutral-50'
                }`}
                data-region={region.id}
                data-color={region.color}
              >
                <span class="text-xl">{region.flag}</span>
                <span>{lang === 'es' ? region.name : region.nameEn}</span>
              </button>
            ))}
          </div>
        </div>
      </div>
    )}

    <!-- Featured Region Details (if selected) -->
    {displayRegion && (
      <div class="mb-16" id="region-details">
        <div class={`bg-gradient-to-br ${displayRegion.bgGradient} rounded-3xl p-8 lg:p-12 border-2 border-${displayRegion.color}/20 relative overflow-hidden`}>
              
              <!-- Background Pattern -->
              <div class="absolute inset-0 opacity-5">
                <div class="text-9xl absolute top-8 right-8 transform rotate-12">
                  {displayRegion.flag}
                </div>
              </div>

              <div class="relative z-10 grid lg:grid-cols-2 gap-8 items-start">
                
                <!-- Region Overview -->
                <div class="space-y-6">
                  <div class="space-y-4">
                    <div class="flex items-center space-x-4">
                      <div class="text-4xl">{displayRegion.flag}</div>
                      <div>
                        <h3 class="text-3xl font-bold text-neutral-900">
                          {lang === 'es' ? displayRegion.name : displayRegion.nameEn}
                        </h3>
                        <p class="text-lg text-neutral-600">
                          {lang === 'es' ? displayRegion.description : displayRegion.descriptionEn}
                        </p>
                      </div>
                    </div>
                  </div>

                  <!-- Market Stats -->
                  <div class="bg-white bg-opacity-80 backdrop-blur-sm rounded-xl p-6 space-y-4">
                    <h4 class="font-semibold text-neutral-900 mb-4">
                      {lang === 'es' ? 'Datos del Mercado' : 'Market Data'}
                    </h4>
                    
                    <div class="grid grid-cols-2 gap-4">
                      <div>
                        <div class="text-2xl font-bold text-primary">{displayRegion.marketSize}</div>
                        <div class="text-sm text-neutral-600">
                          {lang === 'es' ? 'Tama√±o de Mercado' : 'Market Size'}
                        </div>
                      </div>
                      <div>
                        <div class="text-2xl font-bold text-success">{displayRegion.growthRate}</div>
                        <div class="text-sm text-neutral-600">
                          {lang === 'es' ? 'Crecimiento Anual' : 'Annual Growth'}
                        </div>
                      </div>
                      <div>
                        <div class="text-2xl font-bold text-accent">{displayRegion.clients}</div>
                        <div class="text-sm text-neutral-600">
                          {lang === 'es' ? 'Clientes Activos' : 'Active Clients'}
                        </div>
                      </div>
                      <div>
                        <div class="text-2xl font-bold text-info">{displayRegion.established}</div>
                        <div class="text-sm text-neutral-600">
                          {lang === 'es' ? 'A√±o de Inicio' : 'Established'}
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- Key Insights */
                  <div class="space-y-3">
                    <h4 class="font-semibold text-neutral-900">
                      {lang === 'es' ? 'Tendencias Clave' : 'Key Insights'}
                    </h4>
                    <div class="grid gap-3">
                      {displayRegion.insights.map((insight) => (
                        <div class="bg-white bg-opacity-60 rounded-lg p-4 flex items-center justify-between">
                          <div>
                            <div class="font-medium text-neutral-900">{insight.title}</div>
                            <div class="text-sm text-neutral-600">{insight.desc}</div>
                          </div>
                          <div class="text-xl font-bold text-primary">{insight.value}</div>
                        </div>
                      ))}
                    </div>
                  </div>
                </div>

                <!-- Detailed Information -->
                <div class="space-y-6">
                  
                  <!-- Shipping Information -->
                  <div class="bg-white bg-opacity-80 backdrop-blur-sm rounded-xl p-6">
                    <h4 class="font-semibold text-neutral-900 mb-4 flex items-center">
                      <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" />
                      </svg>
                      {lang === 'es' ? 'Informaci√≥n de Env√≠o' : 'Shipping Information'}
                    </h4>
                    
                    <div class="space-y-3">
                      <div class="flex justify-between">
                        <span class="text-neutral-600">{lang === 'es' ? 'Tiempo de tr√°nsito:' : 'Transit time:'}</span>
                        <span class="font-medium">{displayRegion.shipping.transit} {displayRegion.shipping.transitUnit}</span>
                      </div>
                      <div class="flex justify-between">
                        <span class="text-neutral-600">{lang === 'es' ? 'Frecuencia:' : 'Frequency:'}</span>
                        <span class="font-medium">{displayRegion.shipping.frequency}</span>
                      </div>
                      <div class="flex justify-between">
                        <span class="text-neutral-600">{lang === 'es' ? 'M√©todo:' : 'Method:'}</span>
                        <span class="font-medium">{displayRegion.shipping.method}</span>
                      </div>
                      <div class="flex justify-between">
                        <span class="text-neutral-600">Incoterm:</span>
                        <span class="font-medium">{displayRegion.shipping.incoterm}</span>
                      </div>
                    </div>

                    <div class="mt-4 pt-4 border-t border-neutral-200">
                      <h5 class="font-medium text-neutral-900 mb-2">
                        {lang === 'es' ? 'Puertos Principales:' : 'Main Ports:'}
                      </h5>
                      <div class="flex flex-wrap gap-2">
                        {(lang === 'es' ? displayRegion.keyPorts : displayRegion.keyPortsEn).map((port) => (
                          <span class="px-3 py-1 bg-primary bg-opacity-10 text-primary rounded-full text-sm font-medium">
                            {port}
                          </span>
                        ))}
                      </div>
                    </div>
                  </div>

                  <!-- Product Preferences -->
                  <div class="bg-white bg-opacity-80 backdrop-blur-sm rounded-xl p-6">
                    <h4 class="font-semibold text-neutral-900 mb-4 flex items-center">
                      <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4" />
                      </svg>
                      {lang === 'es' ? 'Preferencias de Producto' : 'Product Preferences'}
                    </h4>
                    
                    <div class="space-y-4">
                      {/* Lupins */}
                      <div class="border border-neutral-200 rounded-lg p-4">
                        <div class="flex items-center justify-between mb-2">
                          <h5 class="font-medium text-neutral-900">
                            {lang === 'es' ? 'Lupinos' : 'Lupins'}
                          </h5>
                          <span class={`px-2 py-1 rounded-full text-xs font-medium ${
                            displayRegion.products.lupins.demand === 'very-high' ? 'bg-success bg-opacity-20 text-success' :
                            displayRegion.products.lupins.demand === 'high' ? 'bg-accent bg-opacity-20 text-accent' :
                            'bg-info bg-opacity-20 text-info'
                          }`}>
                            {displayRegion.products.lupins.demand === 'very-high' ? (lang === 'es' ? 'Muy Alta' : 'Very High') :
                             displayRegion.products.lupins.demand === 'high' ? (lang === 'es' ? 'Alta' : 'High') :
                             (lang === 'es' ? 'Media' : 'Medium')}
                          </span>
                        </div>
                        <div class="text-sm text-neutral-600 space-y-1">
                          <div><strong>{lang === 'es' ? 'Calibres:' : 'Calibers:'}</strong> {displayRegion.products.lupins.calibers.join(', ')}</div>
                          <div><strong>{lang === 'es' ? 'Empaque:' : 'Packaging:'}</strong> {displayRegion.products.lupins.packaging.join(', ')}</div>
                          <div><strong>{lang === 'es' ? 'Temporada:' : 'Season:'}</strong> {displayRegion.products.lupins.seasonality}</div>
                        </div>
                      </div>

                      {/* Cherries */}
                      <div class="border border-neutral-200 rounded-lg p-4">
                        <div class="flex items-center justify-between mb-2">
                          <h5 class="font-medium text-neutral-900">
                            {lang === 'es' ? 'Cerezas' : 'Cherries'}
                          </h5>
                          <span class={`px-2 py-1 rounded-full text-xs font-medium ${
                            displayRegion.products.cherries.demand === 'very-high' ? 'bg-success bg-opacity-20 text-success' :
                            displayRegion.products.cherries.demand === 'high' ? 'bg-accent bg-opacity-20 text-accent' :
                            'bg-info bg-opacity-20 text-info'
                          }`}>
                            {displayRegion.products.cherries.demand === 'very-high' ? (lang === 'es' ? 'Muy Alta' : 'Very High') :
                             displayRegion.products.cherries.demand === 'high' ? (lang === 'es' ? 'Alta' : 'High') :
                             (lang === 'es' ? 'Media' : 'Medium')}
                          </span>
                        </div>
                        <div class="text-sm text-neutral-600 space-y-1">
                          <div><strong>{lang === 'es' ? 'Empaque:' : 'Packaging:'}</strong> {displayRegion.products.cherries.packaging.join(', ')}</div>
                          <div><strong>{lang === 'es' ? 'Temporada:' : 'Season:'}</strong> {displayRegion.products.cherries.seasonality}</div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- Regional Executive -->
                  <div class="bg-white bg-opacity-80 backdrop-blur-sm rounded-xl p-6">
                    <h4 class="font-semibold text-neutral-900 mb-4 flex items-center">
                      <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                      </svg>
                      {lang === 'es' ? 'Tu Ejecutivo Regional' : 'Your Regional Executive'}
                    </h4>
                    
                    <div class="flex items-start space-x-4">
                      <div class="w-16 h-16 bg-primary bg-opacity-10 rounded-xl flex items-center justify-center flex-shrink-0">
                        <span class="text-2xl font-bold text-primary">
                          {displayRegion.executive.name.split(' ').map(n => n[0]).join('')}
                        </span>
                      </div>
                      
                      <div class="flex-grow space-y-2">
                        <div>
                          <h5 class="font-semibold text-neutral-900">{displayRegion.executive.name}</h5>
                          <p class="text-sm text-neutral-600">{displayRegion.executive.title}</p>
                        </div>
                        
                        <div class="space-y-1 text-sm">
                          <div class="flex items-center space-x-2">
                            <svg class="w-4 h-4 text-neutral-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                            </svg>
                            <a href={`mailto:${displayRegion.executive.email}`} class="text-primary hover:underline">
                              {displayRegion.executive.email}
                            </a>
                          </div>
                          <div class="flex items-center space-x-2">
                            <svg class="w-4 h-4 text-neutral-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
                            </svg>
                            <a href={`tel:${displayRegion.executive.phone}`} class="text-secondary hover:underline">
                              {displayRegion.executive.phone}
                            </a>
                          </div>
                          <div class="text-neutral-600">
                            <strong>{lang === 'es' ? 'Idiomas:' : 'Languages:'}</strong> {displayRegion.executive.languages.join(', ')}
                          </div>
                          <div class="text-neutral-600">
                            <strong>{lang === 'es' ? 'Experiencia:' : 'Experience:'}</strong> {displayRegion.executive.experience}
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
        </div>
      </div>
    )}

    <!-- All Regions Overview (if no specific region selected) -->
    {!selectedRegion && (
      <div class="grid md:grid-cols-3 gap-8 mb-16">
        {regionsData.map((region) => (
          <div class={`bg-gradient-to-br ${region.bgGradient} rounded-2xl p-6 border-2 border-${region.color}/20 hover:border-${region.color}/40 transition-all duration-300 group cursor-pointer`}
               data-region-card={region.id}>
            
            <div class="space-y-4">
              <!-- Region Header -->
              <div class="flex items-center space-x-3">
                <div class="text-3xl">{region.flag}</div>
                <div>
                  <h3 class="text-xl font-bold text-neutral-900">
                    {lang === 'es' ? region.name : region.nameEn}
                  </h3>
                  <p class="text-sm text-neutral-600">
                    {region.clients} {lang === 'es' ? 'clientes activos' : 'active clients'}
                  </p>
                </div>
              </div>

              <!-- Quick Stats -->
              <div class="grid grid-cols-2 gap-3">
                <div class="bg-white bg-opacity-60 rounded-lg p-3 text-center">
                  <div class="text-lg font-bold text-primary">{region.marketSize}</div>
                  <div class="text-xs text-neutral-600">
                    {lang === 'es' ? 'Mercado' : 'Market'}
                  </div>
                </div>
                <div class="bg-white bg-opacity-60 rounded-lg p-3 text-center">
                  <div class="text-lg font-bold text-success">{region.growthRate}</div>
                  <div class="text-xs text-neutral-600">
                    {lang === 'es' ? 'Crecimiento' : 'Growth'}
                  </div>
                </div>
              </div>

              <!-- Key Info -->
              <div class="text-sm text-neutral-700">
                {lang === 'es' ? region.description : region.descriptionEn}
              </div>

              <!-- Executive -->
              <div class="flex items-center space-x-3 bg-white bg-opacity-60 rounded-lg p-3">
                <div class="w-8 h-8 bg-primary bg-opacity-20 rounded-full flex items-center justify-center">
                  <span class="text-xs font-bold text-primary">
                    {region.executive.name.split(' ').map(n => n[0]).join('')}
                  </span>
                </div>
                <div>
                  <div class="font-medium text-neutral-900 text-sm">{region.executive.name}</div>
                  <div class="text-xs text-neutral-600">{region.executive.title}</div>
                </div>
              </div>

              <!-- CTA -->
              <button
                type="button"
                class={`btn btn-${region.color} w-full py-3 text-sm group-hover:shadow-lg transition-all`}
                onclick={`selectRegion('${region.id}'); gtag && gtag('event', 'region_select', { event_label: '${region.id}' })`}
              >
                {lang === 'es' ? 'Ver Detalles' : 'View Details'}
                <svg class="w-4 h-4 ml-2 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
                </svg>
              </button>
            </div>
          </div>
        ))}
      </div>
    )}

    <!-- Call to Action -->
    <div class="text-center">
      <div class="bg-gradient-to-r from-primary/5 to-secondary/5 rounded-2xl p-8 border border-primary border-opacity-20">
        <h3 class="text-2xl font-bold text-neutral-900 mb-4">
          {lang === 'es' ? '¬øListo para exportar a tu regi√≥n?' : 'Ready to export to your region?'}
        </h3>
        <p class="text-neutral-700 mb-6 max-w-2xl mx-auto">
          {lang === 'es' 
            ? 'Conecta directamente con nuestros ejecutivos regionales para una cotizaci√≥n personalizada seg√∫n tu mercado.'
            : 'Connect directly with our regional executives for a personalized quote according to your market.'
          }
        </p>
        <div class="flex flex-col sm:flex-row gap-4 justify-center">
          <a 
            href="#contacto"
            class="btn btn-primary px-8 py-4 inline-flex items-center group"
            onclick={`gtag && gtag('event', 'cta_click', { event_label: 'regions_contact', custom_parameter_region: '${selectedRegion || 'all'}' })`}
          >
            {lang === 'es' ? 'Contactar Ejecutivo' : 'Contact Executive'}
            <svg class="w-5 h-5 ml-2 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
            </svg>
          </a>
          
          <a 
            href="/documents/agracom-mercados-regionales.pdf"
            class="btn btn-secondary px-8 py-4 inline-flex items-center group"
            download
            onclick={`gtag && gtag('event', 'resource_download', { event_label: 'regional_markets_pdf' })`}
          >
            {lang === 'es' ? 'Gu√≠a de Mercados' : 'Markets Guide'}
            <svg class="w-5 h-5 ml-2 group-hover:translate-y-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
            </svg>
          </a>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Regions Interactive JavaScript -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
    const regionSelectors = document.querySelectorAll('.region-selector');
    const regionDetails = document.getElementById('region-details');
    const regionCards = document.querySelectorAll('[data-region-card]');

    // Region selector functionality
    function selectRegion(regionId: string) {
      // Update button states
      regionSelectors.forEach(btn => {
        const btnElement = btn as HTMLElement;
        const btnRegion = btnElement.dataset.region;
        const btnColor = btnElement.dataset.color;
        
        if (btnRegion === regionId) {
          btn.className = `region-selector px-6 py-4 rounded-xl font-medium transition-all duration-300 flex items-center space-x-3 bg-${btnColor} text-white shadow-md`;
        } else {
          btn.className = 'region-selector px-6 py-4 rounded-xl font-medium transition-all duration-300 flex items-center space-x-3 text-neutral-600 hover:bg-neutral-50';
        }
      });

      // Update URL without page reload
      const url = new URL(window.location.href);
      url.searchParams.set('region', regionId);
      window.history.pushState({}, '', url.toString());

      // Scroll to details if they exist
      if (regionDetails) {
        regionDetails.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }

      // Track region selection
      if (typeof (window as any).gtag !== 'undefined') {
        (window as any).gtag('event', 'region_select', {
          event_category: 'Regions',
          event_label: regionId
        });
      }
    }

    // Make selectRegion globally available
    (window as any).selectRegion = selectRegion;

    // Add click listeners to region selectors
    regionSelectors.forEach(btn => {
      btn.addEventListener('click', () => {
        const btnElement = btn as HTMLElement;
        const regionId = btnElement.dataset.region;
        if (regionId) selectRegion(regionId);
      });
    });

    // Add click listeners to region cards
    regionCards.forEach(card => {
      card.addEventListener('click', () => {
        const cardElement = card as HTMLElement;
        const regionId = cardElement.dataset.regionCard;
        if (regionId) selectRegion(regionId);
      });
    });

    // Initialize from URL parameter
    const urlParams = new URLSearchParams(window.location.search);
    const initialRegion = urlParams.get('region');
    if (initialRegion && regionSelectors.length > 0) {
      selectRegion(initialRegion);
    }

    // Intersection Observer for tracking region views
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          if (typeof (window as any).gtag !== 'undefined') {
            (window as any).gtag('event', 'regions_section_view', {
              event_category: 'Regions',
              event_label: 'section_viewed'
            });
          }
          observer.unobserve(entry.target);
        }
      });
    }, { threshold: 0.3 });

    const regionsSection = document.getElementById('regiones');
    if (regionsSection) {
      observer.observe(regionsSection);
    }
  });
</script>

<style>
  /* Enhanced region selector styling */
  .region-selector {
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .region-selector:hover {
    transform: translateY(-2px);
  }

  /* Region card hover effects */
  [data-region-card] {
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  [data-region-card]:hover {
    transform: translateY(-4px);
    box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
  }

  /* Demand level indicators */
  .bg-success\/20 {
    background-color: rgba(76, 175, 80, 0.2);
  }

  .bg-accent\/20 {
    background-color: rgba(255, 160, 0, 0.2);
  }

  .bg-info\/20 {
    background-color: rgba(2, 136, 209, 0.2);
  }

  /* Smooth scroll behavior */
  html {
    scroll-behavior: smooth;
  }

  /* Mobile responsiveness */
  @media (max-width: 768px) {
    .region-selector {
      padding: 0.75rem 1rem;
      font-size: 0.875rem;
    }

    .region-selector span {
      font-size: 1rem;
    }

    .grid.lg\\:grid-cols-2 {
      grid-template-columns: 1fr;
      gap: 2rem;
    }

    .grid.md\\:grid-cols-3 {
      grid-template-columns: 1fr;
      gap: 1.5rem;
    }
  }

  /* High contrast mode support */
  @media (prefers-contrast: high) {
    .bg-white\/80,
    .bg-white\/60 {
      background-color: white;
      border: 2px solid #000;
    }
  }

  /* Reduced motion support */
  @media (prefers-reduced-motion: reduce) {
    .region-selector,
    [data-region-card],
    .transition-all,
    .transition-transform {
      transition: none;
    }

    .region-selector:hover,
    [data-region-card]:hover {
      transform: none;
    }

    html {
      scroll-behavior: auto;
    }
  }

  /* Focus styles for accessibility */
  .region-selector:focus,
  [data-region-card]:focus {
    outline: 2px solid var(--color-accent);
    outline-offset: 2px;
  }
</style>